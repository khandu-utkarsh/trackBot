# generated by datamodel-codegen:
#   filename:  openapi.yaml
#   timestamp: 2025-06-11T14:18:30+00:00

from __future__ import annotations

from datetime import datetime
from enum import Enum
from typing import Any, Optional

from pydantic import AnyUrl, BaseModel, EmailStr, Extra, Field, conint


class User(BaseModel):
    class Config:
        extra = Extra.forbid

    id: int = Field(
        ...,
        description='Unique identifier for the user. Created by the database.',
        example=1,
    )
    email: EmailStr = Field(
        ...,
        description="User's email address. This is the primary key for the user and obtained from Google Auth.",
        example='user@gmail.com',
    )
    name: str = Field(
        ..., description="User's full name from Google profile.", example='John Doe'
    )
    picture: AnyUrl = Field(
        ...,
        description="User's profile picture URL from Google.",
        example='https://lh3.googleusercontent.com/...',
    )
    created_at: Optional[datetime] = Field(
        None,
        description='Timestamp when the user was created. Created by the database.',
        example='2024-01-15T10:30:00Z',
    )


class CreateUserRequest(BaseModel):
    class Config:
        extra = Extra.forbid

    email: EmailStr = Field(
        ...,
        description="User's email address obtained from Google Auth.",
        example='user@gmail.com',
    )


class CreateUserResponse(BaseModel):
    class Config:
        extra = Extra.forbid

    id: int = Field(
        ..., description='ID of the created user. Created by the database.', example=1
    )
    email: EmailStr = Field(
        ..., description="User's email address.", example='user@gmail.com'
    )


class GoogleLoginRequest(BaseModel):
    class Config:
        extra = Extra.forbid

    googleToken: str = Field(
        ...,
        description='Google JWT credential token',
        example='eyJhbGciOiJSUzI1NiIsImtpZCI6...',
    )


class Conversation(BaseModel):
    class Config:
        extra = Extra.forbid

    id: int = Field(..., description='Unique ID for the conversation.', example=1)
    user_id: int = Field(..., description='ID of the user.', example=42)
    title: str = Field(
        ..., description='Conversation title.', example='Workout Planning'
    )
    updated_at: datetime = Field(
        ..., description='Timestamp of update.', example='2024-01-15T10:30:00Z'
    )


class CreateConversationRequest(BaseModel):
    class Config:
        extra = Extra.forbid

    title: str = Field(
        ..., description='Title of the conversation.', example='Workout Planning'
    )


class CreateConversationResponse(BaseModel):
    class Config:
        extra = Extra.forbid

    id: int
    title: str
    user_id: int
    updated_at: datetime


class UpdateConversationRequest(BaseModel):
    class Config:
        extra = Extra.forbid

    title: Optional[str] = Field(
        None, description='Updated title of the conversation.', example='Revised Plan'
    )


class ListConversationsResponse(BaseModel):
    class Config:
        extra = Extra.forbid

    conversations: list[Conversation]


class DeleteConversationRequest(BaseModel):
    class Config:
        extra = Extra.forbid

    confirm: Optional[bool] = Field(
        False,
        description='Confirmation flag to prevent accidental deletion.',
        example=True,
    )


class DeleteConversationResponse(BaseModel):
    class Config:
        extra = Extra.forbid

    id: int = Field(..., description='ID of the deleted conversation.', example=1)
    title: str = Field(
        ...,
        description='Title of the deleted conversation.',
        example='Workout Planning',
    )
    deleted_at: datetime = Field(
        ...,
        description='Timestamp when the conversation was deleted.',
        example='2024-01-15T10:30:00Z',
    )
    messages_deleted_count: int = Field(
        ...,
        description='Number of messages that were deleted along with the conversation.',
        example=15,
    )


class MessageType(Enum):
    user = 'user'
    assistant = 'assistant'


class Message(BaseModel):
    id: int = Field(..., description='Unique identifier for the message.', example=1)
    conversation_id: int = Field(
        ..., description='Conversation ID this message belongs to.', example=1
    )
    user_id: int = Field(..., description='User ID who sent the message.', example=1)
    langchain_message: str = Field(
        ...,
        description='Langchain message json.',
        example='I want to start a new workout plan',
    )
    message_type: MessageType
    created_at: Optional[datetime] = Field(
        None, description='Creation timestamp.', example='2024-01-15T10:30:00Z'
    )


class CreateMessageRequest(BaseModel):
    class Config:
        extra = Extra.forbid

    langchain_message: str = Field(
        ...,
        description='Langchain message json.',
        example='I want to start a new workout plan',
    )
    message_type: MessageType


class ListMessagesRequest(BaseModel):
    class Config:
        extra = Extra.forbid

    conversation_id: Optional[int] = None
    user_id: Optional[int] = None
    limit: Optional[conint(ge=1, le=100)] = None
    offset: Optional[conint(ge=0)] = None


class ListMessagesResponse(BaseModel):
    class Config:
        extra = Extra.forbid

    messages: list[Message]


class Error(BaseModel):
    code: str = Field(..., description='Error code', example='INVALID_INPUT')
    message: str = Field(
        ...,
        description='Human-readable error message',
        example='The provided input is invalid',
    )
    details: Optional[dict[str, Any]] = Field(
        None, description='Additional error details'
    )
